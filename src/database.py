# import psycopg2
import sqlalchemy
from sqlalchemy.orm import sessionmaker
from datetime import datetime, timedelta, date
from src.config import DATABASE_URL
from src.models import Base, Horses, Schedule, Rent, TrainTypes, TrainTypeTrainType, Users, UserRole, UserStatus, RentStatus, ScheduleStatus, Review


engine = sqlalchemy.create_engine(DATABASE_URL)
SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)
session = SessionLocal()

if __name__ == '__main__':
    print("–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö...")
    
    Base.metadata.drop_all(engine)
    Base.metadata.create_all(engine)
    
    print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ.")
    print("–í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –º–µ—Å—Ç–µ.")

    def generate_const_data():
        # --- –ë–∞–∑–æ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ ---
        horse1 = Horses(horse_name="–£–º–∫–∞")
        horse2 = Horses(horse_name="–ó–∏–Ω–≥–µ—Ä")
        horse3 = Horses(horse_name="–ì–æ—Å—É–¥–∞—Ä—ã–Ω—è")
        horse4 = Horses(horse_name="–¢—É–º–∞–Ω")
        
        train_type_trial = TrainTypes(train_type=TrainTypeTrainType.trial)
        train_type_sub = TrainTypes(train_type=TrainTypeTrainType.rent)

        review_1 = Review(text = 
                          """–•–æ—á–µ—Ç—Å—è —Å–∫–∞–∑–∞—Ç—å —á—Ç–æ —Å–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ –≤ –∂–∏–∑–Ω–∏ —Å–ø–æ—Ä—Ç—Å–º–µ–Ω–∞ - —ç—Ç–æ —Ç—Ä–µ–Ω–µ—Ä. –ú–Ω–æ–≥–æ –ª–µ—Ç —è –∏—Å–∫–∞–ª–∞ —Ç—Ä–µ–Ω–µ—Ä–∞, —Å –∫–æ—Ç–æ—Ä—ã–º —Å–º–æ–≥—É —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è, –∏ –Ω–∞–∫–æ–Ω–µ—Ü —Ç–æ —è –Ω–∞—à–ª–∞ –µ–≥–æ. 
–Æ–ª—è –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–π —Ç—Ä–µ–Ω–µ—Ä, –æ–±—ä—è—Å–Ω—è–µ—Ç –ø–æ–Ω—è—Ç–Ω—ã–º —è–∑—ã–∫–æ–º, –Ω–µ –ø–æ–≤—ã—à–∞–µ—Ç –≥–æ–ª–æ—Å, –≤—Å–µ–≥–¥–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç, —Ä–∞–¥—É–µ—Ç—Å—è –∏ –≥—Ä—É—Å—Ç–∏—Ç –≤–º–µ—Å—Ç–µ —Å —Ç–æ–±–æ–π. –û–Ω–∞ –≤—Å–µ–≥–¥–∞ –∑–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ –≤—Å–∞–¥–Ω–∏–∫–∞ –∏ –ª–æ—à–∞–¥–∏.
–ö–æ–≥–¥–∞ —Ç–æ —è –¥—É–º–∞–ª–∞, —á—Ç–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—é—Å—å —Å –∫–æ–±—ã–ª–æ–π, –∫–∞–∫ –∂–µ —è –æ—à–∏–±–∞–ª–∞—Å—å) –ê—Å—è –æ—á–µ–Ω—å —á–µ—Å—Ç–Ω–∞—è, –ª–∞—Å–∫–æ–≤–∞—è –∏ –¥–æ–±—Ä–∞—è –∫–æ–±—ã–ª–∞. –í—Å–µ–≥–¥–∞ –≤—ã—Ä—É—á–∏—Ç –∏ –ø–æ–º–æ–∂–µ—Ç, –∞ –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –ø–æ—á–µ—à–µ—Ç—Å—è –æ–± —Ç–µ–±—è:) 
–° –Ω–µ–π —è –ø–æ–¥–Ω–∏–º–∞–ª–∞ –≤—ã—Å–æ—Ç—ã, –≤—ã—à–ª–∞ –Ω–∞ —Å–≤–æ–∏ –ø–µ—Ä–≤—ã–µ —Å—Ç–∞—Ä—Ç—ã –∏ –¥–∞–∂–µ —Å–¥–∞–ª–∞ –Ω–∞ —Ä–∞–∑—Ä—è–¥.""",
                          stars = 5)
        review_2 = Review(text = 
                          """–ï—Å–ª–∏ –≤—ã –Ω–∞—á–∏–Ω–∞—é—â–∏–π, —Å—Ä–µ–¥–Ω–∏–π –∏–ª–∏ —É–≤–µ—Ä–µ–Ω–Ω—ã–π –≤—Å–∞–¥–Ω–∏–∫ –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—á–µ—Ç –Ω–∞–π—Ç–∏ —Å–≤–æ–µ–≥–æ —Ç—Ä–µ–Ω–µ—Ä–∞, —Ç–æ —Å –Æ–ª–∏–µ–π —É –≤–∞—Å —ç—Ç–æ –±–æ–ª–µ–µ —á–µ–º –ø–æ–ª—É—á–∏—Ç—Å—è. 
–Æ–ª—è —Ç–µ—Ä–ø–µ–ª–∏–≤—ã–π, –ø—Ä–∏—è—Ç–Ω—ã–π –∏ –≤–µ—Å—ë–ª—ã–π —Ç—Ä–µ–Ω–µ—Ä. –û–Ω–∞ –≤—Å—ë –¥–æ—Ö–æ–¥—á–∏–≤–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –∏ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç, –∞ –ó—é–∑—è –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–ª–µ—Å—Ç–Ω—ã–π –∫–æ–Ω—å. 
–í—Å—ë –µ—â—ë —Ö–æ–¥–∏–º –∫ –Æ–ª–µ –∏ —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã —Å–∫–∞–∑–∞—Ç—å –µ–π —Å–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–µ —Ç—Ä–µ–Ω–µ—Ä–æ–≤–∫–∏. –Æ–ª–∏—è –≤—ã –ª—É—á—à–∏–π —Ç—Ä–µ–Ω–µ—Ä!!""",
                          stars = 5)
        review_3 = Review(text = 
                          """–ù–∞–π—Ç–∏ —Å–≤–æ–µ–≥–æ —Ç—Ä–µ–Ω–µ—Ä–∞ - —ç—Ç–æ –Ω–∞—Å—Ç–æ—è—â–µ–µ —Å—á–∞—Å—Ç—å–µ!–ü—Ä–∏—à–ª–∞ –∫ –Æ–ª–µ –Ω–∞ –ø—Ä–æ–±–Ω—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –ø–æ—Å–ª–µ –Ω–µ—É–¥–∞—á–Ω–æ–≥–æ –æ–ø—ã—Ç–∞ –∏ —Ç—Ä–∞–≤–º. 
–ü—Ä–∏—à–ª–∞ –∏ –æ—Å—Ç–∞–ª–∞—Å—å, –ø–æ–Ω—è–ª–∞, —á—Ç–æ –Ω–µ —Ö–æ—á—É –∏—Å–∫–∞—Ç—å –Ω–∏ –¥—Ä—É–≥–æ–≥–æ —Ç—Ä–µ–Ω–µ—Ä–∞ –Ω–∏ –∫–æ–Ω—è. –ó–∞–Ω–∏–º–∞—é—Å—å —É–∂–µ –≥–æ–¥ –∏ –±—É–¥—É –∑–∞–Ω–∏–º–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ. 
–Æ–ª—è —Å—É–ø–µ—Ä —Ç—Ä–µ–Ω–µ—Ä, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª —Å–≤–æ–µ–≥–æ –¥–µ–ª–∞, –≤–µ–∂–ª–∏–≤–∞—è, —Ç–∞–∫—Ç–∏—á–Ω–∞—è, –¥–∞–µ—Ç –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–∞ –∫ –Ω—é–∞–Ω—Å–∞–º, –≤—Å–µ —Ä–∞—Å—Å–∫–∞–∂–µ—Ç, –ø–æ–¥–¥–µ—Ä–∂–∏—Ç –∏ –ø–æ–º–æ–∂–µ—Ç –±–æ—Ä–æ—Ç—å—Å—è —Å–æ —Å—Ç—Ä–∞—Ö–∞–º–∏ –∏ –∑–∞–∂–∏–º–∞–º–∏. 
–¢–∞–∫–∏—Ö —Ç—Ä–µ–Ω–µ—Ä–æ–≤ —Å–µ–π—á–∞—Å –∫—Ä–∞–π–Ω–µ –º–∞–ª–æ.–Æ–ª—è —á–µ–ª–æ–≤–µ–∫ —Å –¥–æ–±—Ä—ã–º —Å–µ—Ä–¥—Ü–µ–º, –∫–æ—Ç–æ—Ä—ã–π –ª—é–±–∏—Ç —Å–≤–æ–∏—Ö –ª–æ—à–∞–¥–µ–π –∏ —É—á–µ–Ω–∏–∫–æ–≤. 
–ë–ª–∞–≥–æ–¥–∞—Ä—è —Ç–∞–∫–æ–º—É –ø–æ–¥—Ö–æ–¥—É —É –º–µ–Ω—è –µ—Å—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞—Ö. –ö–∞–∂–¥–æ–µ –∑–∞–Ω—è—Ç–∏–µ, –≥–∞–º–º–∞ —ç–º–æ—Ü–∏–π –∏ —Å—á–∞—Å—Ç—å—è. –ù—É –∏ –∫–æ–Ω–µ—á–Ω–æ –∂–µ –ó–∏–Ω–≥–µ—Ä, —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ª—é–±–æ–≤—å! 
–í—ã—Å–æ–∫–∏–π, –±–æ–ª—å—à–æ–π, —Ç–∞–∫–æ–π –ª–∞—Å–∫–æ–≤—ã–π –∏ –¥–æ–±—Ä—ã–π –∫–æ–Ω—å, –∏–¥–µ–∞–ª—å–Ω—ã–π —É—á–∏—Ç–µ–ª—å.–ü—Ä–æ—Å—Ç–æ –≤ —Å–∞–º–æ–µ —Å–µ—Ä–¥—Ü–µ ‚ô•Ô∏è""",
                          stars = 5)
        review_4 = Review(text = 
                          """–í—Å–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å, –ª–æ—à–∞–¥—å —Ö–æ—Ä–æ—à–æ –æ–±—É—á–µ–Ω–Ω–∞—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è""",
                          stars = 5)
        
        review_5 = Review(text = 
                          """–°–ø–∞—Å–∏–±–æ –±–æ–ª—å—à–æ–µ –Æ–ª–∏–µ –∑–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É. –î–æ—á–∫–µ –æ—á–µ–Ω—å –ø–æ–Ω—Ä–∞–≤–∏–ª–∞—Å—å, —Å–∫–∞–∑–∞–ª–∞, —á—Ç–æ –Ω–∞–∫–æ–Ω–µ—Ü —Ç–æ –º–Ω–µ –≤—Å—ë –æ–±—ä—è—Å–Ω—è—é—Ç. –†–∞–∑–Ω–∏—Ü–∞ –æ–≥—Ä–æ–º–Ω–∞—è —Å –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–∫–∞—Ç–æ–º. –õ–æ—à–∞–¥–∏ —É –Æ–ª–∏ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã–µ! 
–ë—É–¥–µ–º —Å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏. –ê –µ—â—ë –Æ–ª—è —Ä–∞—Å—Å–∫–∞–∑–∞–ª–∞ –∫–∞–∫ —á–∏—Å—Ç–∏—Ç—å –∏ —Å–µ–¥–ª–∞—Ç—å –ª–æ—à–∞–¥—å, –∏ –¥–∞–ª–∞ –ù–∞—Ç–∞—à–µ –≤–æ –≤—Å—ë–º —ç—Ç–æ–º –ø–æ—É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å.""",
                          stars = 5)
        review_6 = Review(text = 
                          """–Æ–ª—è - –ª—É—á—à–∏–π —Ç—Ä–µ–Ω–µ—Ä! –ö–∞–π—Ñ—É—é –æ—Ç –∫–∞–∂–¥–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏.üî•–ó–∏–Ω–≥–µ—Ä-–ø—Ä–µ–∫—Ä–∞—Å–Ω–∞—è –ª–æ—à–∞–¥—å,—Å –æ–≥—Ä–æ–º–Ω—ã–º —Å–µ—Ä–¥—Ü–µ–º ü´∂üèª.""",
                          stars = 5)

        # –°–±–æ—Ä –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –ë–î
        all_data_objects = [
            horse1, horse2, horse3, horse4,
            train_type_trial, train_type_sub,
            review_1, review_2, review_3, review_4, review_5, review_6
        ]
        
        return all_data_objects
    
    data_to_load = generate_const_data()

    try:
        session.add_all(data_to_load)
        session.commit()
        print(f"–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ {len(data_to_load)} –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.")
    except Exception as e:
        print(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {e}")
        session.rollback()
    finally:
        session.close()

